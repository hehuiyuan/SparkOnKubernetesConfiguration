# Spark On Kubernetes Configuration
| 属性名                                                      | 缺省值                               | 说明                                                                                                                                                                                                                                                                                                              |
|:----------------------------------------------------------- |:------------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| spark.kubernetes.namespace                                  | default                              | 运行driver和executor pods的命名空间                                                                                                                                                                                                                                                                               |
| spark.kubernetes.container.image                            | 无                                   | spark应用的容器镜像、必须配置、由用户提供、通常格式为：example.com/repo/spark:v1.0.0                                                                                                                                                                                                                              |
| spark.kubernetes.driver.container.image                     | spark.kubernetes.container.image的值 | driver的自定义镜像                                                                                                                                                                                                                                                                                                |
| spark.kubernetes.executor.container.image                   | spark.kubernetes.container.image的值 | executor的自定义镜像                                                                                                                                                                                                                                                                                              |
| spark.kubernetes.container.image.pullPolicy                 | IfNotPresent                         | 镜像的拉取策略                                                                                                                                                                                                                                                                                                    |
| spark.kubernetes.allocation.batch.size                      | 5                                    | 每轮executor pod调度时单次启动的pod的个数                                                                                                                                                                                                                                                                         |
| spark.kubernetes.allocation.batch.delay                     | 1秒                                  | 每轮executor pod调度之间的等待时间、指定小于1秒的值可能导致spark driver的cpu使用率过高                                                                                                                                                                                                                            |
| spark.kubernetes.authenticate.submission.caCertFile         | 无                                   | 启动driver时通过TLS连接Kubernetes API Server所需的CA证书文件的路径、文件需放置在提交机器的磁盘上、将其指定为路径而不是URI                                                                                                                                                                                         |
| spark.kubernetes.authenticate.submission.clientKeyFile      | 无                                   | 客户端密钥文件的路径，用于在启动driver时针对Kubernetes API Server进行身份验证         、文件需放置在提交机器的磁盘上、将其指定为路径而不是URI                                                                                                                                                                     |
| spark.kubernetes.authenticate.submission.clientCertFile     | 无                                   | 客户端证书文件的路径，用于在启动driver时对Kubernetes API Server进行身份验证    、文件需放置在提交机器的磁盘上、将其指定为路径而不是URI                                                                                                                                                                            |
| spark.kubernetes.authenticate.submission.oauthToken         | 无                                   | 在启动driver时对Kubernetes API Server进行身份验证时使用的OAuth令牌，不同于其他的验证选项，这应该是用于身份验证的令牌的确切字符串值                                                                                                                                                                                |
| spark.kubernetes.authenticate.submission.oauthTokenFile     | 无                                   | OAuth令牌文件的路径，其中包含在启动driver时对Kubernetes API Server进行身份验证时要使用的令牌、文件需放置在提交机器的磁盘上、将其指定为路径而不是URI                                                                                                                                                               |
| spark.kubernetes.authenticate.driver.caCertFile             | 无                                   | 在请求executors时，从driver pod通过TLS连接Kubernetes API Server所需的CA证书文件的路径、          文件需放置在提交机器的磁盘上，并且会上传至driver pod、    将其指定为路径而不是URI                                                                                                                                |
| spark.kubernetes.authenticate.driver.clientKeyFile          | 无                                   | 在请求executors时，从driver pod向Kubernetes API Server进行身份验证时所需的客户端密钥文件的路径、          文件需放置在提交机器的磁盘上，并且会上传至driver pod、    将其指定为路径而不是URI、如果指定了此项，强烈建议为driver提交服务器设置TLS，因为该值是以明文方式传递给driver pod的敏感信息                    |
| spark.kubernetes.authenticate.driver.clientCertFile         | 无                                   | 在请求executor时，用于从driver pod对Kubernetes API Server进行身份验证的客户端证书文件的路径    、文件需放置在提交机器的磁盘上，并且会上传至driver pod、将其指定为路径而不是URI                                                                                                                                    |
| spark.kubernetes.authenticate.driver.oauthToken             | 无                                   | 在请求executor时，从driver  pod向Kubernetes API Server进行身份验证时使用的OAuth令牌、请注意，与其他身份验证选项不同，这必须是用于身份验证的令牌的确切字符串值、该令牌值会上传至driver pod、           如果指定了此项，强烈建议为driver提交服务器设置TLS，因为该值是以明文方式传递给driver pod的敏感信息           |
| spark.kubernetes.authenticate.driver.oauthTokenFile         | 无                                   | 在请求executor时，从driver  pod向Kubernetes API Server进行身份验证时使用的OAuth令牌文件的路径、请注意，与其他身份验证选项不同，这必须是用于身份验证的令牌的确切字符串值、该令牌值会上传至driver pod、           如果指定了此项，强烈建议为driver提交服务器设置TLS，因为该值是以明文方式传递给driver pod的敏感信息 |
| spark.kubernetes.authenticate.driver.mounted.caCertFile     | 无                                   | 在请求executors时，从driver pod通过TLS连接Kubernetes API Server所需的CA证书文件的路、必须可以从driver pod访问该路径  、将其指定为路径而不是URI                                                                                                                                                                    |
| spark.kubernetes.authenticate.driver.mounted.clientKeyFile  | 无                                   | 在请求executors时，从driver pod向Kubernetes API Server进行身份验证时所需的客户端密钥文件的路径、 必须可以从driver pod访问该路径  、将其指定为路径而不是URI                                                                                                                                                        |
| spark.kubernetes.authenticate.driver.mounted.clientCertFile | 无                                   | 在请求executor时，用于从driver pod对Kubernetes API Server进行身份验证的客户端证书文件的路径 、    必须可以从driver pod访问该路径  、将其指定为路径而不是URI                                                                                                                                                       |
| spark.kubernetes.authenticate.driver.mounted.oauthTokenFile | 无                                   | 请求executor时，从driver pod向Kubernetes API Server进行身份验证时使用的包含OAuth令牌的文件的路径、       必须可以从driver pod访问该路径、                请注意，与其他身份验证选项不同，这必须是用于身份验证的令牌的确切字符串值                                                                                 |
| spark.kubernetes.authenticate.driver.serviceAccountName     | default                              | 运行driver pod时使用的服务账户、driver pod在向api server请求executor pod时会使用该服务账户、请注意这不能与CA证书文件，客户端密钥文件，客户端证书文件，和/或OAuth令牌一起指定                                                                                                                                      |
| spark.kubernetes.driver.label.[LabelName]                   | 无                                   | 将LabelName指定的标签添加到driver pod、例如，spark.kubernetes.driver.label.something=true、注意spark还会在driver pod中加自己的标签用于簿记                                                                                                                                                                        |
| spark.kubernetes.driver.annotation.[AnnotationName]         | 无                                   | 将AnnotationName指定的注释添加到driver pod、例如，spark.kubernetes.driver.annotation.something=true                                                                                                                                                                                                               |
| spark.kubernetes.executor.label.[LabelName]                 | 无                                   | 将LabelName指定的标签添加到executor pods、例如，spark.kubernetes.executor.label.something=true、      注意spark还会在driver pod中加自己的标签用于簿记                                                                                                                                                             |
| spark.kubernetes.executor.annotation.[AnnotationName]       | 无                                   | 将AnnotationName指定的注释添加到executor pods、例如，spark.kubernetes.executor.annotation.something=true                                                                                                                                                                                                          |
| spark.kubernetes.driver.pod.name                            | 无                                   | driver pod的名字、如果没有设置，driver pod的名字会被设置成"spark.app.name"加后缀为当前时间戳来避免名字冲突                                                                                                                                                                                                        |
| spark.kubernetes.executor.lostCheck.maxAttempts             | 30                                   | driver尝试确定一个特定的executor丢失原因的次数、丢失的原因用于确定executor的失败是框架原因还是应用程序的错误，该结论反过来用来决定executor是否要被删除或替换，或是置于一个失败待调试的状态                                                                                                                        |
| spark.kubernetes.submission.waitAppCompletion               | true                                 | 在集群模式下，是否在退出启动进程前等待应用程序结束、当修改为false时，启动Spark任务启动器会出现"即发即弃"的行为                                                                                                                                                                                                    |
| spark.kubernetes.report.interval                            | 1秒                                  | 集群模式下，报告当前Spark任务运行状态的间隔时间                                                                                                                                                                                                                                                                   |
| spark.kubernetes.driver.limit.cores                         | 无                                   | 为driver pod指定硬CPU［限制］https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/#resource-requests-and-limits-of-pod-and-container                                                                                                                                              |
| spark.kubernetes.executor.limit.cores                       | 无                                   | 为Spark应用程序启动的每个executor pod指定硬CPU［限制］   https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/#resource-requests-and-limits-of-pod-and-container                                                                                                                  |
| spark.kubernetes.node.selector.[labelKey]                   | 无                                   | 添加driver pod和executor pod的节点选择器，键是labelKey，值为配置值、例如，设置spark.kubernetes.node.selector.identifier的值为myIdentifier会导致drive pod和executor pods有一个键为identifier值为myIdentifier的节点选择器、可以通过设置包含多个该前缀的配置来添加多个节点选择器                                     |
| spark.kubernetes.driverEnv.[EnvironmentVariableName]        | 无                                   | 将EnvironmentVariableName指定的环境变量添加到driver进程，用户可以通过指定多个这样的参数来指定多个环境变量                                                                                                                                                                                                         |
| spark.kubernetes.mountDependencies.jarsDownloadDir          | /var/spark-data/spark-jars           | 在dirver和executor中下载jar包的位置、此目录必须为空，并且将作为空目录卷挂载到dirver pod和executor pods                                                                                                                                                                                                            |
| spark.kubernetes.mountDependencies.filesDownloadDir         | /var/spark-data/spark-files          | 在dirver和executor中下载文件的位置、此目录必须为空，并且将作为空目录卷挂载到dirver pod和executor pods                                                                                                                                                                                                             |
| spark.kubernetes.mountDependencies.timeout                  | 300秒                                | 在终止从远程下载和解压依赖到driver和executor pod尝试的超时时间（秒为单位）                                                                                                                                                                                                                                        |
| spark.kubernetes.mountDependencies.maxSimultaneousDownloads | 5                                    | 同时下载到单个dirver或executor pod中的远程依赖的个数                                                                                                                                                                                                                                                              |
| spark.kubernetes.initContainer.image                        | spark.kubernetes.container.image的值 | 用于driver和executor初始化容器的自定义容器镜像                                                                                                                                                                                                                                                                    |
| spark.kubernetes.driver.secrets.[SecretName]                | 无                                   | 添加名为SecretName的Kubernetes Secret到drive pod中由value指定的路径、例如，spark.kubernetes.driver.secrets.spark-secret=/etc/secrets、注意，如果使用初始化容器(init-container)，  secret也会被添加到driver pod的初始化容器(init-container)中                                                                      |
| spark.kubernetes.executor.secrets.[SecretName]                                                            |   无                                   |   添加名为SecretName的Kubernetes Secret到executor pod中由value指定的路径、例如，spark.kubernetes.executor.secrets.spark-secret=/etc/secrets、注意，如果使用初始化容器(init-container)，  secret也会被添加到executor pod的初始化容器(init-container)中                                                                                                                                                                                                                                                                                                                  |

